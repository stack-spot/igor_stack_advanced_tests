name: template_hook_tests
description: Template used to test hooks and triggers
types:
  - app-template
inputs:
  - label: Project name
    type: text
    name: project_name
    default: project-name
  - label: Input1
    type: text
    name: input1
  - label: Input2
    type: text
    name: input2
hooks:
  ## ---------------------------------------
  ## ---------- HOOK TYPE: RUN
  ## ---------------------------------------
  - type: run
    trigger: before-input
    linux:
      - echo "hello from run-hook-before-input on Linux"
    mac:
      - echo "hello from run-hook-before-input on Mac"
    windows:
      - cmd /C echo "hello from run-hook-before-input on Windows"
  - type: run
    trigger: before-render
    linux:
      - echo "hello from run-hook-before-render on Linux"
      - sh {{component_path}}/scripts/unix/assert_file_not_found.sh README.md
    mac:
      - echo "hello from run-hook-before-render on Mac"
      - sh {{component_path}}/scripts/unix/assert_file_not_found.sh README.md
    windows:
      - cmd /C echo "hello from run-hook-before-render on Windows"
      - cmd /C "{{component_path}}\scripts\windows\assert_file_not_found.bat" README.md
  - type: run
    trigger: after-render
    linux:
      - echo "hello from run-hook-after-render on Linux"
      - sh {{component_path}}/scripts/unix/assert_file_found.sh README.md
    mac:
      - echo "hello from run-hook-after-render on Mac"
      - sh {{component_path}}/scripts/unix/assert_file_found.sh README.md
    windows:
      - cmd /C echo "hello from run-hook-after-render on Windows"
      - cmd /C "{{component_path}}\scripts\windows\assert_file_found.bat" README.md
  ## ---------------------------------------
  ## ---------- HOOK TYPE: RUN-SCRIPT
  ## ---------------------------------------
  - type: run-script
    trigger: before-input
    script: scripts/assert_inputs_empty.py
  - type: run-script
    trigger: before-render
    script: scripts/assert_readme_not_found.py
  - type: run-script
    trigger: after-render
    script: scripts/assert_readme_found.py
  ## ---------------------------------------
  ## ---------- HOOK TYPE: EDIT
  ## ---------------------------------------
  - type: edit
    trigger: after-render
    path: src/some-file.txt
    changes:
      - insert:
          line: 0
          value: " # This is the base text "
          when:
            not-exists: "StringABCD"
      - search:
          string: "# This is the base text "
          insert-before:
            snippet: snippets/before-base-text.txt
          when:
            not-exists: "StringABCD"
            not-exists-snippet: snippets/before-base-text.txt
      - search:
          string: "# This is the base text "
          insert-after:
            value: "# After base text"
      - search:
          pattern: (A )sample( text)
          replace-by:
            value: \1sample edited\2
          when:
            not-exists: "StringABCD"
  # ---------------------------------------
  # ---------- HOOK TYPE: EDIT-XML
  # ---------------------------------------
  - type: edit-xml
    trigger: after-render
    path: pom-sample.xml
    encoding: UTF-8
    indent: "\t"
    changes:
      - xpath: .//dependencies
        append:
          value: |
            <dependency>  
              <groupId>junit</groupId>  
              <artifactId>junit</artifactId>  
              <version>4.8.2</version>  
              <scope>test</scope>
              <{{input1}}>{{input2}}</{{input1}}>
            </dependency>
        prepend:
          value: <{{input1}}>{{input2}}</{{input1}}>
